## 資料庫欄位型態 VARCHAR 跟 TEXT 的差別是什麼

### char 與 varchar 的差別

1. 這兩個東西都可以指定長度，但是當指定的長度比儲存的資料還長時:
    * char 會用空格補滿剩下的長度，比方說：指定 char 長度為 10，儲存了 hi 只用了 2 個單位，那剩下的 8 個單位就會用空格補滿，所以儲存時還是用了 10 單位。
    * varchar 不會補滿，一樣的條件，就會是只用 2 單位儲存。
    -> 也因為這個特性，char 的長度是固定的，而 varchar 的長度是根據輸入的值而定，所以在讀取上 char 會比較快。

2. 若儲存的資料超過了指定的長度的話，超過的部分會被截斷。比方說指定 10 單位，但嘗試存了一筆資料叫做 abcdefghijklmnop，這樣就會只存到 abcdefghij。
3. 可儲存的長度不同
    * char 最多只能存 0 ~ 255 位元的資料
    * varchar 在 5.0.3 之後的版本可以存 (2的16次方-1) 位元
4. 儲存在裡面的字串長度可以被定義。
5. 資料是直接被儲存在 table 裡面的。

### text

1. 不能指定長度 ( 指定了不會顯示錯誤 )，但是超過指定長度的內容還是會被寫入。 ( 前提是內容長度還在寫入上限內 ) 
2. 可以儲存的長度跟 varchr 一樣也是 ( 2的16次方-1 ) 位元。
3. 可以儲存 "不是 unicode編碼" 的字，所以可以支援的符號比較多，但在同樣的字數的情況下存 "非 unicode" 需要的位元會比 "unicode" 的位元還多。
4. 儲存在裡面的字串長度沒辦法被定義。
5. 不是直接存在 table 裡面，而是把儲存的位置放在那個 table 裡面。( 我想這是為甚麼 text 設置了索引的這個功能，幫助搜尋，對嗎?)


### 查完資料的小總結

大部分的資料顯示這兩種資料形式，在小範圍的時候好像沒有太大的差異，但是儲存的形式會影響檢索資料的速度跟使用的大小。
1. 如果是不知道長度的東西或有奇奇怪怪的符號 -> 用 text
2. 已知長度，且內容是某種固定形式的東西 -> 用 varchar
3. 固定長度的東西，而且長度小於 255 位元 -> 用 char

 
#### 其他 memo

1. 可以存成數字的話不要存成字串，不然比對時間會變長。字串要一個一個比對字元，但數字只要比對一次就行。
2. 前綴 var 的東西( 舉varchar為例 )代表長度依據儲存的東西而定 ( 不會用空格填滿 )，但讀取的時候要跑一下。( 節省空間但讀取慢 )
3. 沒有前綴的( 舉char為例 ) 代表儲存長度固定 ( 就是指定的那個長度 )，沒存滿會用空格填滿。( 讀取快但浪費空間 )


## Cookie 是什麼？在 HTTP 這一層要怎麼設定 Cookie，瀏覽器又是怎麼把 Cookie 帶去 Server 的？

### cookie 有點像是一個有紀錄訊息的令牌(通行證(?))，這個令牌帶的資訊可以讓 sever 獲得一些額外的資訊。
- 舉例來說：使用者登入之後，server 發一個令牌，上面標示這個使用者 ( userA ) 的身分，之後 userA 發其他 request 時出示這個令牌，這樣伺服器才能知道:[ 阿~原來這個 request 是 userA 發的呀! ]，不然對於 server 來說，每個 request 之間是沒有關聯性的。( 對 server 來說每個 request 都是獨立的個體! )

### 在 client 端送出資料之後，sever 回 response 時，會在 header 裡面用 `SETCOOKIE()` 這個指令把相對應的資料附進去 -> client 端獲得一個附有資料的 cookie，而在這個 cookie 還沒過期之前，client 端發 request 時都會順便帶上這個資料 ( 有點像是專門提供額外資訊的 request 附屬配件這樣 )



## 我們本週實作的會員系統，你能夠想到什麼潛在的問題嗎？
### 目前版本的身分驗證都只有一層的防護，只要想辦法獲得 token 之後就能直接偽裝成使用者 ( 比方說:有人有柯南般的速記能力，從螢幕上看到直接背起來、在傳送的過程中被攔截、或是駭進資料庫裏面...等等 )，目前想到的加強方式有以下幾種：

1. 傳送方式 ( 暗號傳送，再解碼 )

    如果可以像二戰時的電報密碼一樣，把 token 經過特殊的規則編碼，傳送出去，接收方再按照約定的規則解讀。這樣如果資料在傳送間被人攔截，但因為不知道要怎麼解讀，就算拿到 token 也辦法直接傳入，就沒辦法達到假冒身分的目的。

2. 存放資料的方式 ( 查一次表 變 查多次表 )

    目前 token 跟 username 是直接存在一起的，如果是用資料庫被駭的角度來看，等於只用了一個資料庫的密碼來保護 username，駭客直接拿這些 username 去登入系統測試就可以找到使用者的密碼了。( 這樣就不只是冒用帳號，還能獲得使用者其他的個人資訊 )

    ->
    但如果用查兩三次表的方式去找 username ，這樣就算前面第一層 token 的資料庫被駭了，只要後面的第二層，第三層有守住，那趕快把外洩的部份全部換掉，這樣 username 就不會外洩了。
    ( 如果以這個角度來看，這幾個 table 是不是應該要分散在各個伺服器呢？如果資料庫被駭應該是同一個伺服器的資料都會外洩對嗎？)

3. 沒辦法確認對方身分 ( 創造一個信物 )

    目前雖然用戶輸入帳號密碼可以讓 server 端可以辨別用戶，但使用者無法辨別 "要求資料的人" 是不是真的目標對象，比方說：詐騙網站騙使用者輸入帳號密碼就是 "要求資料的人是假的" 的情況。而且另一方面 "送資料來的人" 也有可能是假的，比方說：駭客盜刷信用卡的情況。
    
    ->
    在資料內容中增加某種信物的機制，或是像刺客們找同伴的時候一樣要說口訣，以辨別雙方身分。
    ( 不過想了一下，網路憑證不就是信物的一種嗎 ~ 只是網路憑證是由第三方發的證明，而且只能確認 "要求資料的人" 的身分這樣。 )
    ( 而 google 登入新裝置時要雙重認證，應該就是 "確認送資料來的人是否為真" 的一種操作方法了。 )

---
# 功能面目前想到的部分:

1. 沒有申請帳號的限制，這樣其實本質上應該跟沒有帳號管理差不多?
   -> 可以申請大量帳號，仍然可以帶風向或洗版之類的。
2. 沒有找回帳號密碼的機制
3. 沒有編輯留言的機制
   -> 使用者體驗不太好